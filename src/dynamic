#!/bin/sh

echo -e "127.0.0.1\tlocalhost" > /etc/hosts
echo -e "127.0.1.1\t$(hostname).lxc.brakkedoos.nl\t$(hostname)" >> /etc/hosts
echo >> /etc/hosts
echo "# generated by /root/dynamic-inv.sh" >> /etc/hosts

for n in $(nmap -sP IP | grep report | awk '{print $6}' | egrep -v "\.1$" | cut -d"(" -f2 | cut -d")" -f1); do
	echo -e "${n}\t$(ssh ${n} hostname 2> /dev/null).lxc.brakkedoos.nl" >> /etc/hosts
done

echo "" >> /etc/hosts
echo -e "::1\tip6-localhost ip6-loopback" >> /etc/hosts
echo -e "::1\t$(hostname).lxc.brakkedoos.nl\t$(hostname)\tlocalhost" >> /etc/host

echo "[lxc-servers]" > /root/dynamic-hosts
nmap -sP IP | grep report | awk '{print $5}' | egrep -v "\.1$" >> /root/dynamic-hosts
